From 3aedfb6e39933b9035f645b68e6602c4a80565e4 Mon Sep 17 00:00:00 2001
From: Marek 'marx' Grac <mgrac@redhat.com>
Date: Wed, 18 Feb 2015 10:47:44 +0100
Subject: [PATCH 10/16] Revert "COMPATIBILITY BREAK: fence_drac5 replace --m /
 --modulename / modulename / module_name with standard -n / --plug / port"

---
 fence/agents/drac5/fence_drac5.py | 12 +++++++++++-
 fence/agents/lib/fencing.py.py    |  2 ++
 2 files changed, 13 insertions(+), 1 deletion(-)

diff --git a/fence/agents/drac5/fence_drac5.py b/fence/agents/drac5/fence_drac5.py
index 070fe41..ee669ef 100644
--- a/fence/agents/drac5/fence_drac5.py
+++ b/fence/agents/drac5/fence_drac5.py
@@ -101,10 +101,17 @@ def define_new_opts():
 		"shortdesc" : "Force DRAC version to use (DRAC 5, DRAC CMC, DRAC MC)",
 		"choices" : ["DRAC CMC", "DRAC MC", "DRAC 5"],
 		"order" : 1}
+	all_opt["module_name"] = {
+		"getopt" : "m:",
+		"longopt" : "module-name",
+		"help" : "-m, --module-name=<module>     DRAC/MC module name",
+		"required" : "0",
+		"shortdesc" : "DRAC/MC module name",
+		"order" : 1}
 
 def main():
 	device_opt = ["ipaddr", "login", "passwd", "cmd_prompt", "secure", \
-			"drac_version", "port", "no_port", "telnet"]
+			"drac_version", "module_name", "port", "no_port", "telnet"]
 
 	atexit.register(atexit_handler)
 
@@ -114,6 +121,9 @@ def main():
 
 	options = check_input(device_opt, process_input(device_opt))
 
+	if "--module-name" in options:
+		options["--plug"] = options["--module-name"]
+
 	docs = {}
 	docs["shortdesc"] = "Fence agent for Dell DRAC CMC/5"
 	docs["longdesc"] = "fence_drac5 is an I/O Fencing agent \
diff --git a/fence/agents/lib/fencing.py.py b/fence/agents/lib/fencing.py.py
index ec5f855..902a32f 100644
--- a/fence/agents/lib/fencing.py.py
+++ b/fence/agents/lib/fencing.py.py
@@ -1253,6 +1253,8 @@ def _parse_input_stdin(avail_opt):
 			name = "port"
 		elif name == "hostname":
 			name = "ipaddr"
+		elif name == "modulename":
+			name = "module_name"
 
 		if avail_opt.count(name) == 0 and name in ["nodename"]:
 			continue
-- 
1.9.3

