From 2e0f266904cabfe4fe1cd669ae267fa8594a5937 Mon Sep 17 00:00:00 2001
From: Marek 'marx' Grac <mgrac@redhat.com>
Date: Thu, 30 Jun 2016 01:41:05 +0200
Subject: [PATCH 1/2] fence_ipmilan: Do not print password to debug info

already fixed in upstream

Resolves: rhbz#1358064
---
 fence/agents/lib/fencing.py.py | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/fence/agents/lib/fencing.py.py b/fence/agents/lib/fencing.py.py
index bc8556e..5bd9f0e 100644
--- a/fence/agents/lib/fencing.py.py
+++ b/fence/agents/lib/fencing.py.py
@@ -936,7 +936,11 @@ def run_command(options, command, timeout=None, env=None):
 	if timeout is not None:
 		timeout = float(timeout)
 
-	logging.info("Executing: %s\n", command)
+	# For IPMI password occurs on command line, it should not be part of debug info
+	log_command = command
+	if "ipmitool" in log_command:
+		log_command = re.sub("-P (.+?) -p", "-P [set] -p", log_command)
+	logging.info("Executing: %s\n", log_command)
 
 	try:
 		process = subprocess.Popen(shlex.split(command), stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=env)
-- 
2.4.11

